<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B-Code - Editar Perfil</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <style>
        #editor {
            height: 200px;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-6">Editar Perfil</h1>
        <form id="editProfileForm" class="bg-white rounded-lg shadow-md p-6">
            <!-- Banner -->
            <div class="mb-4">
                <label for="banner" class="block text-sm font-medium text-gray-700 mb-2">Banner</label>
                <input type="file" id="banner" accept="image/*" class="w-full p-2 border rounded">
                <div class="mt-2">
                    <label class="inline-flex items-center">
                        <input type="checkbox" id="useAnimatedBanner" class="form-checkbox">
                        <span class="ml-2">Usar banner animado</span>
                    </label>
                </div>
            </div>

            <!-- Foto de Perfil -->
            <div class="mb-4">
                <label for="profilePic" class="block text-sm font-medium text-gray-700 mb-2">Foto de Perfil</label>
                <input type="file" id="profilePic" accept="image/*" class="w-full p-2 border rounded">
                <div class="mt-2">
                    <label for="frameStyle" class="block text-sm font-medium text-gray-700 mb-2">Estilo da Moldura</label>
                    <select id="frameStyle" class="w-full p-2 border rounded">
                        <option value="1">Moldura 1 (Dourada)</option>
                        <option value="2">Moldura 2 (Prata)</option>
                        <option value="3">Moldura 3 (Bronze)</option>
                        <option value="4">Moldura 4 (Vermelha)</option>
                    </select>
                </div>
            </div>

            <!-- Informações Básicas -->
            <div class="mb-4">
                <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                <input type="text" id="fullName" class="w-full p-2 border rounded">
            </div>

            <div class="mb-4">
                <label for="username" class="block text-sm font-medium text-gray-700 mb-2">Nome de Usuário</label>
                <input type="text" id="username" class="w-full p-2 border rounded">
            </div>

            <div class="mb-4">
                <label for="gender" class="block text-sm font-medium text-gray-700 mb-2">Gênero</label>
                <select id="gender" class="w-full p-2 border rounded">
                    <option value="Masculino">Masculino</option>
                    <option value="Feminino">Feminino</option>
                    <option value="Outro">Outro</option>
                    <option value="Prefiro não dizer">Prefiro não dizer</option>
                </select>
            </div>

            <!-- Biografia -->
            <div class="mb-4">
                <label for="editor" class="block text-sm font-medium text-gray-700 mb-2">Biografia</label>
                <div id="editor"></div>
            </div>

            <!-- Background Personalizado -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Background Personalizado</label>
                <div>
                    <label class="inline-flex items-center">
                        <input type="radio" name="backgroundType" value="color" checked class="form-radio">
                        <span class="ml-2">Cor Sólida</span>
                    </label>
                    <label class="inline-flex items-center ml-4">
                        <input type="radio" name="backgroundType" value="gradient" class="form-radio">
                        <span class="ml-2">Gradiente</span>
                    </label>
                    <label class="inline-flex items-center ml-4">
                        <input type="radio" name="backgroundType" value="3d" class="form-radio">
                        <span class="ml-2">3D Animado</span>
                    </label>
                </div>
                <div id="colorPicker" class="mt-2">
                    <input type="color" id="backgroundColor" class="w-full p-2 border rounded">
                </div>
                <div id="gradientPicker" class="mt-2 hidden">
                    <input type="color" id="gradientColor1" class="w-1/2 p-2 border rounded">
                    <input type="color" id="gradientColor2" class="w-1/2 p-2 border rounded">
                </div>
                <div id="3dPicker" class="mt-2 hidden">
                    <select id="3dShape" class="w-full p-2 border rounded">
                        <option value="cube">Cubo</option>
                        <option value="sphere">Esfera</option>
                        <option value="torus">Torus</option>
                    </select>
                    <input type="color" id="3dColor" class="w-full mt-2 p-2 border rounded">
                </div>
            </div>

            <!-- Links Sociais -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Links Sociais</label>
                <div id="socialLinksContainer"></div>
                <button type="button" id="addSocialLink" class="mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Adicionar Link Social</button>
            </div>

            <!-- Projetos -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Projetos</label>
                <div id="projectsContainer"></div>
                <button type="button" id="addProject" class="mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Adicionar Projeto</button>
            </div>

            <!-- Informações de Contato -->
            <div class="mb-4">
                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                <input type="email" id="email" class="w-full p-2 border rounded">
            </div>

            <div class="mb-4">
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                <input type="tel" id="phone" class="w-full p-2 border rounded">
            </div>

            <!-- Informações de Trabalho -->
            <div class="mb-4">
                <label for="work" class="block text-sm font-medium text-gray-700 mb-2">Experiência Profissional</label>
                <textarea id="work" rows="3" class="w-full p-2 border rounded"></textarea>
            </div>

            <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Salvar Alterações</button>
        </form>
    </div>

    <script type="module">
        // Importar Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD4FmKe7ei-mcKH4flhnXq9TtwmxfUeq5k",
            authDomain: "b-code-881b2.firebaseapp.com",
            databaseURL: "https://b-code-881b2-default-rtdb.firebaseio.com",
            projectId: "b-code-881b2",
            storageBucket: "b-code-881b2.firebasestorage.app",
            messagingSenderId: "199379425544",
            appId: "1:199379425544:web:2e9ac129c58ca9ee37b4bd",
            measurementId: "G-9FEKL6WX7C"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Inicializar Quill
        var quill = new Quill('#editor', {
            theme: 'snow'
        });

        // Carregar dados do perfil
        function loadProfileData(userId) {
            const userRef = ref(database, `users/${userId}`);
            onValue(userRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('fullName').value = data.fullName || '';
                    document.getElementById('username').value = data.username || '';
                    document.getElementById('gender').value = data.gender || '';
                    document.getElementById('email').value = data.email || '';
                    document.getElementById('phone').value = data.phone || '';
                    document.getElementById('work').value = data.work || '';
                    document.getElementById('frameStyle').value = data.frameStyle || '1';
                    quill.root.innerHTML = data.bio || '';

                    // Carregar links sociais
                    if (data.socialLinks) {
                        Object.entries(data.socialLinks).forEach(([platform, url]) => {
                            addSocialLinkField(platform, url);
                        });
                    }

                    // Carregar projetos
                    if (data.projects) {
                        data.projects.forEach(project => {
                            addProjectField(project);
                        });
                    }

                    // Carregar configurações de background
                    if (data.background3D) {
                        document.querySelector('input[name="backgroundType"][value="3d"]').checked = true;
                        document.getElementById('3dShape').value = data.background3D.shape || 'cube';
                        document.getElementById('3dColor').value = data.background3D.color || '#00ff00';
                        toggleBackgroundPickers();
                    } else if (data.backgroundGradient) {
                        document.querySelector('input[name="backgroundType"][value="gradient"]').checked = true;
                        document.getElementById('gradientColor1').value = data.backgroundGradient.color1 || '#ffffff';
                        document.getElementById('gradientColor2').value = data.backgroundGradient.color2 || '#000000';
                        toggleBackgroundPickers();
                    } else {
                        document.getElementById('backgroundColor').value = data.backgroundColor || '#ffffff';
                    }
                }
            });
        }

        // Adicionar campo de link social
        function addSocialLinkField(platform = '', url = '') {
            const container = document.getElementById('socialLinksContainer');
            const linkField = document.createElement('div');
            linkField.className = 'flex items-center mb-2';
            linkField.innerHTML = `
                <input type="text" placeholder="Plataforma" value="${platform}" class="w-1/3 p-2 border rounded mr-2">
                <input type="url" placeholder="URL" value="${url}" class="w-1/2 p-2 border rounded mr-2">
                <button type="button" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600">Remover</button>
            `;
            container.appendChild(linkField);

            linkField.querySelector('button').addEventListener('click', () => {
                container.removeChild(linkField);
            });
        }

        // Adicionar campo de projeto
        function addProjectField(project = {}) {
            const container = document.getElementById('projectsContainer');
            const projectField = document.createElement('div');
            projectField.className = 'border p-4 rounded mb-4';
            projectField.innerHTML = `
                <input type="text" placeholder="Título" value="${project.title || ''}" class="w-full p-2 border rounded mb-2">
                <input type="text" placeholder="Subtítulo" value="${project.subtitle || ''}" class="w-full p-2 border rounded mb-2">
                <textarea placeholder="Descrição" class="w-full p-2 border rounded mb-2">${project.description || ''}</textarea>
                <input type="url" placeholder="Link" value="${project.link || ''}" class="w-full p-2 border rounded mb-2">
                <input type="file" accept="image/*" class="w-full p-2 border rounded mb-2">
                <button type="button" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600">Remover Projeto</button>
            `;
            container.appendChild(projectField);

            projectField.querySelector('button').addEventListener('click', () => {
                container.removeChild(projectField);
            });
        }

        // Toggle background pickers
        function toggleBackgroundPickers() {
            const backgroundType = document.querySelector('input[name="backgroundType"]:checked').value;
            document.getElementById('colorPicker').style.display = backgroundType === 'color' ? 'block' : 'none';
            document.getElementById('gradientPicker').style.display = backgroundType === 'gradient' ? 'block' : 'none';
            document.getElementById('3dPicker').style.display = backgroundType === '3d' ? 'block' : 'none';
        }

        // Event Listeners
        document.getElementById('addSocialLink').addEventListener('click', () => addSocialLinkField());
        document.getElementById('addProject').addEventListener('click', () => addProjectField());
        document.querySelectorAll('input[name="backgroundType"]').forEach(radio => {
            radio.addEventListener('change', toggleBackgroundPickers);
        });

        // Salvar alterações
        document.getElementById('editProfileForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const userId = auth.currentUser.uid;
            const updatedProfile = {
                fullName: document.getElementById('fullName').value,
                username: document.getElementById('username').value,
                gender: document.getElementById('gender').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                work: document.getElementById('work').value,
                frameStyle: document.getElementById('frameStyle').value,
                bio: quill.root.innerHTML,
                socialLinks: {},
                projects: []
            };

            // Coletar links sociais
            document.querySelectorAll('#socialLinksContainer > div').forEach(linkField => {
                const inputs = linkField.querySelectorAll('input');
                updatedProfile.socialLinks[inputs[0].value] = inputs[1].value;
            });

            // Coletar projetos
            document.querySelectorAll('#projectsContainer > div').forEach(projectField => {Entendi. Vou criar uma versão mais completa e funcional do `index.html` (que incluirá o perfil do usuário) e do `editprofile.html`. Vou assumir que o usuário já está cadastrado e autenticado.



Primeiro, vamos criar o arquivo `index.html` que incluirá o perfil do usuário:

```html
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B-Code - Perfil do Usuário</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
        .sidebar.closed {
            transform: translateX(-100%);
        }
        #background3D {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .profile-frame {
            border: 4px solid;
            border-radius: 50%;
        }
        .frame-1 { border-color: gold; }
        .frame-2 { border-color: silver; }
        .frame-3 { border-color: #cd7f32; }
        .frame-4 { border-color: #e44d26; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="background3D"></div>
    <div class="flex">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar bg-gray-800 text-white w-64 min-h-screen p-4">
            <button id="toggleSidebar" class="mb-4 bg-blue-500 text-white px-4 py-2 rounded">
                <i class="fas fa-bars"></i> Menu
            </button>
            <nav>
                <ul>
                    <li><a href="#" class="block py-2 hover:bg-gray-700 rounded px-2"><i class="fas fa-users mr-2"></i>Área Social</a></li>
                    <li><a href="#" class="block py-2 hover:bg-gray-700 rounded px-2"><i class="fas fa-flask mr-2"></i>Laboratório</a></li>
                    <li><a href="#" class="block py-2 hover:bg-gray-700 rounded px-2"><i class="fas fa-project-diagram mr-2"></i>Centro De Projetos</a></li>
                    <li><a href="#" class="block py-2 hover:bg-gray-700 rounded px-2"><i class="fas fa-envelope mr-2"></i>Mensagens</a></li>
                    <li><a href="editprofile.html" class="block py-2 hover:bg-gray-700 rounded px-2"><i class="fas fa-user-edit mr-2"></i>Editar Perfil</a></li>
                    <li><a href="#" class="block py-2 hover:bg-gray-700 rounded px-2"><i class="fas fa-cog mr-2"></i>Configuração</a></li>
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-4">
            <div id="profile" class="bg-white rounded-lg shadow-md p-6">
                <!-- Banner -->
                <div id="banner" class="h-48 bg-cover bg-center rounded-t-lg relative">
                    <div id="bannerOverlay" class="absolute inset-0 bg-black opacity-50"></div>
                    <h1 id="fullName" class="absolute bottom-4 left-4 text-4xl font-bold text-white"></h1>
                </div>

                <!-- Profile Info -->
                <div class="flex items-center -mt-12 mb-4 relative z-10">
                    <img id="profilePic" src="" alt="Profile Picture" class="w-24 h-24 rounded-full border-4 border-white profile-frame">
                    <div class="ml-4">
                        <p id="username" class="text-xl font-semibold text-gray-800"></p>
                        <p id="gender" class="text-gray-600"></p>
                        <div id="status" class="text-sm font-medium"></div>
                    </div>
                </div>

                <!-- Biography -->
                <div id="bio" class="mb-6 p-4 border rounded bg-gray-50"></div>

                <!-- Social Links -->
                <div id="socialLinks" class="mb-6 flex flex-wrap gap-2"></div>

                <!-- Projects -->
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold mb-4">Projetos</h2>
                    <div class="swiper-container">
                        <div id="projectsSlider" class="swiper-wrapper"></div>
                        <div class="swiper-pagination"></div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>
                </div>

                <!-- Contact Info -->
                <div id="contactInfo" class="mb-6"></div>

                <!-- Work Info -->
                <div id="workInfo" class="mb-6"></div>
            </div>
        </div>
    </div>

    <script type="module">
        // Importar Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD4FmKe7ei-mcKH4flhnXq9TtwmxfUeq5k",
            authDomain: "b-code-881b2.firebaseapp.com",
            databaseURL: "https://b-code-881b2-default-rtdb.firebaseio.com",
            projectId: "b-code-881b2",
            storageBucket: "b-code-881b2.firebasestorage.app",
            messagingSenderId: "199379425544",
            appId: "1:199379425544:web:2e9ac129c58ca9ee37b4bd",
            measurementId: "G-9FEKL6WX7C"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Função para carregar dados do perfil
        function loadProfileData(userId) {
            const userRef = ref(database, `users/${userId}`);
            onValue(userRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('fullName').textContent = data.fullName;
                    document.getElementById('username').textContent = `@${data.username}`;
                    document.getElementById('gender').textContent = data.gender || 'Não especificado';
                    document.getElementById('bio').innerHTML = data.bio || 'Nenhuma biografia adicionada.';
                    document.getElementById('banner').style.backgroundImage = `url(${data.banner || 'https://via.placeholder.com/1000x250'})`;
                    document.getElementById('profilePic').src = data.profilePic || 'https://via.placeholder.com/150';
                    document.getElementById('profilePic').className = `w-24 h-24 rounded-full border-4 border-white profile-frame frame-${data.frameStyle || '1'}`;
                    
                    // Status
                    const statusEl = document.getElementById('status');
                    statusEl.textContent = data.status || 'Offline';
                    statusEl.className = `text-sm font-medium ${data.status === 'Online' ? 'text-green-500' : 'text-gray-500'}`;

                    // Carregar links sociais
                    const socialLinksContainer = document.getElementById('socialLinks');
                    socialLinksContainer.innerHTML = '';
                    if (data.socialLinks) {
                        for (const [platform, url] of Object.entries(data.socialLinks)) {
                            const link = document.createElement('a');
                            link.href = url;
                            link.target = "_blank";
                            link.className = 'bg-blue-500 text-white px-3 py-1 rounded-full text-sm hover:bg-blue-600 transition duration-300';
                            link.innerHTML = `<i class="fab fa-${platform.toLowerCase()} mr-1"></i>${platform}`;
                            socialLinksContainer.appendChild(link);
                        }
                    }

                    // Carregar projetos
                    const projectsSlider = document.getElementById('projectsSlider');
                    projectsSlider.innerHTML = '';
                    if (data.projects) {
                        data.projects.forEach(project => {
                            const slide = document.createElement('div');
                            slide.className = 'swiper-slide bg-white rounded-lg shadow-md p-4';
                            slide.innerHTML = `
                                <img src="${project.image || 'https://via.placeholder.com/300x200'}" alt="${project.title}" class="w-full h-40 object-cover rounded-t-lg mb-4">
                                <h3 class="text-xl font-semibold mb-2">${project.title}</h3>
                                <p class="text-gray-600 mb-2">${project.subtitle}</p>
                                <p class="text-sm mb-4">${project.description}</p>
                                <a href="${project.link}" target="_blank" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition duration-300">Ver Projeto</a>
                            `;
                            projectsSlider.appendChild(slide);
                        });
                        new Swiper('.swiper-container', {
                            slidesPerView: 1,
                            spaceBetween: 30,
                            navigation: {
                                nextEl: '.swiper-button-next',
                                prevEl: '.swiper-button-prev',
                            },
                            pagination: {
                                el: '.swiper-pagination',
                                clickable: true,
                            },
                            breakpoints: {
                                640: {
                                    slidesPerView: 2,
                                },
                                768: {
                                    slidesPerView: 3,
                                },
                            },
                        });
                    }

                    // Carregar informações de contato
                    const contactInfo = document.getElementById('contactInfo');
                    contactInfo.innerHTML = `
                        <h2 class="text-2xl font-semibold mb-4">Contato</h2>
                        <p><i class="fas fa-envelope mr-2"></i>${data.email}</p>
                        ${data.phone ? `<p><i class="fas fa-phone mr-2"></i>${data.phone}</p>` : ''}
                    `;

                    // Carregar informações de trabalho
                    const workInfo = document.getElementById('workInfo');
                    workInfo.innerHTML = `
                        <h2 class="text-2xl font-semibold mb-4">Experiência Profissional</h2>
                        <p><i class="fas fa-briefcase mr-2"></i>${data.work || 'Nenhuma informação de trabalho adicionada.'}</p>
                    `;

                    // Configurar background 3D
                    if (data.background3D) {
                        setupBackground3D(data.background3D);
                    }
                }
            });
        }

        // Função para configurar o background 3D
        function setupBackground3D(config) {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('background3D').appendChild(renderer.domElement);

            const geometry = new THREE.TorusKnotGeometry(10, 3, 100, 16);
            const material = new THREE.MeshBasicMaterial({ color: config.color || 0x00ff00, wireframe: true });
            const torusKnot = new THREE.Mesh(geometry, material);
            scene.add(torusKnot);

            camera.position.z = 30;

            function animate() {
                requestAnimationFrame(animate);
                torusKnot.rotation.x += 0.01;
                torusKnot.rotation.y += 0.01;
                renderer.render(scene, camera);
            }
            animate();
        }

        // Verificar o estado de autenticação do usuário
        onAuthStateChanged(auth, (user) => {
            if (user) {
                loadProfileData(user.uid);
            } else {
                // Redirecionar para a página de login se o usuário não estiver autenticado
                window.location.href = 'login.html';
            }
        });

        // Toggle sidebar
        document.getElementById('toggleSidebar').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('closed');
        });

        // Atualizar status online/offline
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);

        function updateOnlineStatus() {
            const userId = auth.currentUser?.uid;
            if (userId) {
                set(ref(database, `users/${userId}/status`), navigator.onLine ? 'Online' : 'Offline');
            }
        }
    </script>
</body>
    </html>
